<!DOCTYPE html>
<html>
<head>
    <title>{{ book.title }}</title>
</head>
<body>
    <h1>{{ book.title }}</h1>
    <p>Author: {{ book.author }}</p>
    <p>Genre: {{ book.genre }}</p>
    <p>Description: {{ book.description }}</p>

    {% if reading_status %}
    <p>Reading Status: {{ reading_status.status }}</p>
    <p>Progress: {{ reading_status.progress }}%</p>
    {% else %}
    <p>Reading Status: Not Set</p>
    {% endif %}

    <form action="{% url 'reading-status-update' %}" method="post">
        {% csrf_token %}
        <select name="status">
            <option value="read">Read</option>
            <option value="unread">Unread</option>
            <option value="reading">Reading</option>
        </select>
        <input type="number" name="progress" min="0" max="100" placeholder="Progress (%)">
        <input type="hidden" name="book_id" value="{{ book.id }}">
        <button type="submit">Save Reading Status</button>
    </form>

    <br><br>
    <a href="{% url 'book-update' book.pk %}">Edit</a>
    <form action="{% url 'book-delete' book.pk %}" method="post" style="display: inline;">
        {% csrf_token %}
        <button type="submit" onclick="return confirm('Are you sure you want to delete this book?')">Delete</button>
    </form>
    <a href="{% url 'book-list' %}">Back to Book List</a>

    <h2>Reviews</h2>

    {% for review in reviews %}
    <div>
        <p><strong>{{ review.user.username }}</strong></p>
        <p>Rating: {{ review.rating }}</p>
        <p>{{ review.comment }}</p>
        <p><small>Reviewed on {{ review.created_at }}</small></p>
        <a href="{% url 'review-edit' review.pk %}">Edit</a>
        <form action="{% url 'review-delete' review.pk %}" method="post" style="display:inline;">
            {% csrf_token %}
            <button type="submit">Delete</button>
        </form>
    </div>
    {% endfor %}
    
    <a href="{% url 'review-add' book.pk %}">Add a Review</a>
</body>
</html>
